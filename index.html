<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercice 1 - Section épinglée</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
        }

        .spacer {
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
        }

        .pinned-section {
            height: 100vh;
            background: #f8f9fa;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 50px;
        }

        .pinned-section h2 {
            font-size: 3rem;
            margin-bottom: 60px;
            color: #2c3e50;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 40px;
            max-width: 1200px;
            width: 100%;
        }

        .stat-card {
            background: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transform: scale(0.8);
        }

        .stat-number {
            font-size: 4rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1.2rem;
            color: #666;
        }

        .end-spacer {
            height: 100vh;
            background: #2c3e50;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
        }

        .chapter {
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .chapter-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 120%;
            object-fit: cover;
            opacity: 0.3;
            z-index: 1;
        }

        .chapter-content {
            position: relative;
            z-index: 2;
            max-width: 1000px;
            padding: 50px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: center;
        }

        .chapter-text h2 {
            font-size: 3.5rem;
            margin-bottom: 30px;
            color: #2c3e50;
            opacity: 0;
        }

        .chapter-text p {
            font-size: 1.3rem;
            line-height: 1.8;
            color: #555;
            opacity: 0;
        }

        .chapter-image {
            width: 100%;
            height: 400px;
            border-radius: 20px;
            object-fit: cover;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            transform: scale(0);
        }

        .chapter1 {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }

        .chapter2 {
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
        }

        .chapter3 {
            background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);
        }
    </style>
</head>

<body>
    <div class="spacer">Scrollez vers le bas ⬇️</div>

    <section class="pinned-section">
        <h2>Nos Chiffres Clés</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" data-target="500">0</div>
                <div class="stat-label">Clients satisfaits</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" data-target="10">0</div>
                <div class="stat-label">Années d'expérience</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" data-target="1250">0</div>
                <div class="stat-label">Projets réalisés</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" data-target="98">0</div>
                <div class="stat-label">% de satisfaction</div>
            </div>
        </div>
    </section>

    <section class="chapter chapter1">
        <img src="https://picsum.photos/1920/1080?random=1" alt="BG" class="chapter-bg">
        <div class="chapter-content">
            <div class="chapter-text">
                <h2>Chapitre 1 : Les Débuts</h2>
                <p>Tout a commencé par une simple idée. Une vision d'un monde où la créativité et la technologie se
                    rencontrent pour créer des expériences inoubliables.</p>
            </div>
            <img src="https://picsum.photos/600/400?random=10" alt="Chapitre 1" class="chapter-image">
        </div>
    </section>

    <section class="chapter chapter2">
        <img src="https://picsum.photos/1920/1080?random=2" alt="BG" class="chapter-bg">
        <div class="chapter-content">
            <img src="https://picsum.photos/600/400?random=20" alt="Chapitre 2" class="chapter-image">
            <div class="chapter-text">
                <h2>Chapitre 2 : L'Évolution</h2>
                <p>Les années ont passé, les défis se sont multipliés. Mais à chaque obstacle, nous avons appris,
                    grandi, et repoussé les limites de ce qui était possible.</p>
            </div>
        </div>
    </section>

    <section class="chapter chapter3">
        <img src="https://picsum.photos/1920/1080?random=3" alt="BG" class="chapter-bg">
        <div class="chapter-content">
            <div class="chapter-text">
                <h2>Chapitre 3 : L'Avenir</h2>
                <p>Aujourd'hui, nous regardons vers demain avec confiance. L'histoire continue, et le meilleur reste à
                    venir. Rejoignez-nous dans cette aventure.</p>
            </div>
            <img src="https://picsum.photos/600/400?random=30" alt="Chapitre 3" class="chapter-image">
        </div>
    </section>

    <!-- GSAP + ScrollTrigger -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>

    <script>
        gsap.registerPlugin(ScrollTrigger);

        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: '.pinned-section',
                start: 'top top',
                end: '+=3000',           // Pin pendant 3000px
                pin: true,               // Épingle toute la section
                scrub: 1,                // Animation fluide liée au scroll
                markers: true            // Debug : voir les marqueurs
            }
        })

        tl.to('.stat-card', {
            opacity: 1,
            scale: 1,
            duration: 1,
            stagger: 0.3,                  // 0.3 entre chaque carte
            ease: 'power2.out'
        });

        // Animation de comptage pour chaque nombre
        const statNumbers = document.querySelectorAll('.stat-number');

        statNumbers.forEach((number, index) => {
            const target = +number.getAttribute('data-target');
            const obj = { count: 0 };

            // Ajouter l'animation à la timeline avec un délai basé sur l'index
            tl.to(obj, {
                count: target,
                duration: 2,
                ease: 'power1.out',
                onUpdate: () => {
                    number.textContent = Math.floor(obj.count);
                }
            }, index * 0.3);  // Démarre avec le même stagger que les cards
        });

        // Animation des chapitres
        const chapters = document.querySelectorAll('.chapter');

        chapters.forEach((chapter, index) => {
            const tl = gsap.timeline({
                scrollTrigger: {
                    trigger: chapter,
                    start: 'top top',
                    end: '+=2000',              // Pin pendant 2000px
                    pin: true,                  // Épingle chaque chapitre
                    scrub: 1,                   // Animation fluide liée au scroll
                    snap: {
                        snapTo: 1,              // Snap à la fin de l'animation
                        duration: 0.5,          // Durée de l'animation de snap
                        ease: 'power2.inOut'
                    },
                    markers: true
                }
            });

            const bg = chapter.querySelector('.chapter-bg');
            const title = chapter.querySelector('.chapter-text h2');
            const text = chapter.querySelector('.chapter-text p');
            const image = chapter.querySelector('.chapter-image');

            // Animation du titre (fade + slide from left)
            tl.fromTo(title,
                { opacity: 0, x: -100 },
                { opacity: 1, x: 0, duration: 1, ease: 'power2.out' }
            );

            // Animation de l'image (scale from 0)
            tl.fromTo(image,
                { scale: 0 },
                { scale: 1, duration: 1, ease: 'back.out(1.7)' },
                '-=0.5'  // Commence 0.5s avant la fin de l'animation précédente
            );

            // Animation du texte (fade + slide from right)
            tl.fromTo(text,
                { opacity: 0, x: 100 },
                { opacity: 1, x: 0, duration: 1, ease: 'power2.out' },
                '-=0.5'  // Commence 0.5s avant la fin de l'animation précédente
            );

            // Effet parallaxe sur l'image de fond
            gsap.to(bg, {
                y: 200,
                ease: 'none',
                scrollTrigger: {
                    trigger: chapter,
                    start: 'top top',
                    end: 'bottom top',
                    scrub: true
                }
            });
        });

    </script>
</body>

</html>